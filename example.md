# 一些基于bloc来解决的场景举例

> 备注
>> 万分欢迎对此文档提交你的业务场景下对于如何使用bloc的例子。但是请注意去敏 & 做一定的抽象与简化

## 视频处理
假设开发者 X 所在的是一个视频公司下的某个团队，X需要按照一些特征对公司平台的视频节目做一些操作，比如：对于新生产的节目进行质量检测任务、对于热度退去的节目进行删除一些耗费空间的码流来节约资源、对于进入热播的节目触发生产一些高质量码流（比如 4K...）；

那么对之进行拆分后会形成下面几个功能函数：
1. 节目输入函数，参数如下：
	1. 节目种类（choices of 热播节目/非热播节目/新生产节目/已下线节目）
	2. 数量限制（int，视资源而定做一定数量限制）
	3. 排序方式（choices of 上线时间/播放热度/下线时间）
	4. 节目过滤条件（需要时长>/</= xxx；黑名单的类比【比如不选电影】；上线时间范围...）
2. 质量检测函数，参数如下：
	1. 是否检测爆音
	2. 是否检测花屏
	3. 是否检测音画不同步
	4. ...
3. 码流增补/删除函数，参数如下：
	1. 增补码流（choices of 增补 4K 码流/增补 8K 码流/...）
	2. 删除码流（choices of 删除 4K 码流/删除 8K 码流/...）

好了，基于 bloc 的话开发者 X 只需要开发上面几个函数就是了，下面来看看脱离了 X后，能满足一些什么功能：
1. 用户 A 关注提供更高清晰度的视频流选择，其可在 bloc 前端编排一个通过「节目输入函数」来筛选出热播最 top 的节目，并且通过「码流补增函数」来为其增补 4K 码流形成一个任务，然后其可以为其配置类似每一小时执行一次的策略
2. 用户 B 关注的是降低成本，那么其可以在 bloc 前端编排一个通过「节目输入函数」来筛选出非热播节目，并且通过「码流补增函数」来为其删除特定码流形成一个任务，然后其可以为其配置类似每晚 12 点执行一次的策略
3. 用户 C 关注的是电视剧的质量，那么其可以在 bloc 前端编排一个通过「节目输入函数」来筛选出今天新上线的节目，并且通过「质量检测函数」来检测每个节目是否存在特定质量问题，然后其可以为其配置类似每下午 4 点执行一次的策略来保证晚上高峰前能够解决
4. 开发者 Y 在另一个团队，其收到一个责任是保障节目按时上线（比如设置了类似电视剧上线时间前 1 小时要是还未完成转码就报警...）。那么首先，其通过阅读 bloc 上的函数发现已经可以通过「节目输入函数」获取到未来即将上线的节目，那么其自己开发了一个函数：「上线保障报警」，其参数有时间差范围选择（可基于设置的此参数来决定是否要触发报警）。开发者 Y 在部署了自己的 client 后，就可以实现这个功能了，而且其就可以交付出去了，至于触发报警的时长是多久等变量，可以让给 Y 提需求的人自己去 bloc 上设置。（这里如果 Y 能做得更好的话，应该把报警和基于上线时间的过滤功能拆分成两个函数，且把报警通知人作为参数暴露出来，这样带来的优势有：1. 别的用户能够直接复用 Y 开发的报警节点与上线时间过滤节点；2. 假设要修改报警的通知人，就不用再找 Y 来修改代码了）
5. 开发者 Z 又在另一个团队，其总是收到宣传部门的需求，把 xxx 节目的第 n 秒到 k 秒截给我，由于这种需求完全是不规律的，所以每次自己都要改脚本去跑，此时开发者可以开发一个「截视频函数 - 参数包含了输入节目 ID、输入开始时间和结束时间，输出就是节目对应截断好的片段」。提交到 bloc 后，之后宣传部门的人就可以自己在 bloc 通过手动输入参数来生成需要片段并自己下载了。（这里还需要提到的是、如果后续 Z 或者别的用户有动态截视频的需求【比如动漫团队对动漫做了 ai 高燃剧情识别后能够提取出片段时间，对于每个动漫节目都想自动触发截取对应片段】的话，完全可以走 api 触发调用 Z 开发的函数对应任务的执行，api 支持将携带过来的值覆盖到输入参数上，从而实现了复用与基于事件的任务触发）
6. ...
